<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>A Forlorn Shrine</title>
    <style>
        @font-face {
            font-family: "ç­‘ç´«ã‚¢ãƒ³ãƒ†ã‚£ãƒ¼ã‚¯";
            src: url("./ç­‘ç´«-jp-pruned.otf") format("opentype");
        }

        @font-face {
            font-family: "ç­‘ç´«";
            src: url("./ç­‘ç´«-cn-pruned.ttf") format("truetype");
        }

        * {
            user-select: none;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "ç­‘ç´«ã‚¢ãƒ³ãƒ†ã‚£ãƒ¼ã‚¯", "ç­‘ç´«";
        }
        html, body {
            scroll-behavior: smooth;
            overflow: hidden;
            background: #f7f2e9;
        }
        .section {
            width: 100%;
            height: 100vh;
            position: relative;
        }
        /* å°é¢é¡µé¢ */
        
        #cover {
            overflow: hidden;
            display: flex;
            justify-content: center;
            align-items: center;
            color: #fff;
            text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
            position: relative;
        }
        #cover .bg {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 110%;
            height: 110%;
            background: url('./cover.jpg') no-repeat center center;
            background-size: cover;
            transform: translate(-50%, -50%);
            transition: transform 0.1s ease-out;
        }
        #cover .overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
        }
        #cover .text {
            position: relative;
            z-index: 1;
            font-size: 2.5em;
            font-weight: 700;
            width: 100%;
        }
        
        .cover-text {
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .left {
            text-align: center;
            transform: translateX(-20%);
        }

        .right {
            text-align: center;
            transform: translateX(20%);
            white-space: nowrap;
        }
        #quote {
            font-size: 20px; /* æ›´å°çš„å­—ä½“ */
            color: white;
            text-align: center;
            position: absolute;
            bottom: 20px; /* è°ƒæ•´åˆ°é¡µé¢åº•éƒ¨ */
            width: 100%;
            font-style: italic;
            text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.7); /* ç»™æ–‡å­—åŠ ç‚¹é˜´å½±æé«˜å¯è¯»æ€§ */
        }


        /* å†…å®¹é¡µé¢ */
        #content {
            overflow-y: auto;
            padding: 40px 20px;
            background: #D8C6BC;
        }
        h1 {
            text-align: center;
            color: #5a4a42;
            font-weight: 700;
            margin-bottom: 20px;
        }
        /* è¿”å›ä¸Šçº§ç›®å½•æŒ‰é’® */
        .back-btn {
            display: flex;
            margin: 10px auto;
            padding: 8px 15px;
            width: fit-content;
            border: 1px solid #f4c4c3;
            background: rgb(232, 211, 209);
            overflow: hidden;
            color: #5a4a42;
            text-align: center;
            position: relative;
            cursor: default;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            border-radius: 30px;
        }

        .back-btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;   
            background: linear-gradient(90deg, 
                transparent, 
                #F4DDDF, 
                transparent
            );
            transition: 0.5s;
        }

        .back-btn:hover::before { 
            left: 100%;
        }

        .file-container {
            display: flex;
            gap: 10px;
            /* align-items: center; */
            justify-content: center;
        }
        .column {
            max-width: 35%;
            flex: 1;
            background: rgb(232, 211, 209);
            padding: 10px;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.1);
        }
        .column h2, h3 {
            text-align: center;
            font-size: 1.2em;
            margin-bottom: 10px;
            color: #5a4a42;
        }
        /* ç›®å½•å’Œæ–‡ä»¶åˆ—è¡¨ */
        .directory, .file-list {
            list-style: none;
            padding: 0;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        .directory li, .file-list li {
            padding: 8px;
            background: rgb(237, 220, 220);
            /* border-radius: 5px; */
            text-align: left;
            font-weight: 600;
            cursor: default;
            transition: 0.3s;
        }
        .directory li:hover, .file-list li:hover {
            background: #F4DDDF;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.2);
            transform: translateY(-2px);
        }
        /* ä½¿æ•´ä¸ªçŸ©å½¢åŒºåŸŸå¯ç‚¹å‡» */
        .file-list li a {
            display: block;
            width: 100%;
            height: 100%;
            text-decoration: none;
            color: inherit;
            cursor: default;
            /* padding: 8px; */
        }
    </style>
    <script src="quotes.js"></script>
</head>
<body>
    <!-- å°é¢ -->
    <section id="cover" class="section">
        <div class="bg" id="cover-bg"></div>
        <div class="overlay"></div>
        <div class="cover-text">
            <div class="text left">èŠ±æ˜ ãˆã‚‹å„šãæœˆå¤œ</div>
            <div class="text right">é›¨ç–ã‚‰ã«ç·‹ã®å¤©é¢¨</div>
        </div>
        <div id="quote" class="quote"></div>
    </section>

    <!-- å†…å®¹é¡µé¢ -->
    <section id="content" class="section">
        <h1>SUSTech Stat-DS Archive</h1>
        <div id="current-path"></div>
        <div id="directory"></div>
    </section>

    <script>
        const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
        document.getElementById('quote').innerHTML = `${randomQuote.text} <br><span>${randomQuote.author}</span>`;

        document.addEventListener("mousemove", (e) => {
            const bg = document.getElementById("cover-bg");
            const moveX = (window.innerWidth / 2 - e.clientX) * 0.02;
            const moveY = (window.innerHeight / 2 - e.clientY) * 0.02;
            bg.style.transform = `translate(-50%, -50%) translate(${moveX}px, ${moveY}px)`;
        });

        let isScrolling = false;
        let fileStructure = {};
        window.addEventListener('wheel', function(e) {
            if (isScrolling) return;
            const cover = document.getElementById('cover');
            const content = document.getElementById('content');
            if (window.pageYOffset < cover.offsetHeight / 2 && e.deltaY > 0) {
                isScrolling = true;
                content.scrollIntoView({ behavior: "smooth" });
                setTimeout(() => { isScrolling = false; }, 1000);
            } else if (window.pageYOffset >= cover.offsetHeight / 2 && e.deltaY < 0 && content.scrollTop <= 0) {
                isScrolling = true;
                cover.scrollIntoView({ behavior: "smooth" });
                setTimeout(() => { isScrolling = false; }, 1000);
            }
        });

        let touchStartY = 0;
        let touchEndY = 0;

        window.addEventListener('touchstart', function(e) {
            touchStartY = e.touches[0].clientY;
        });

        window.addEventListener('touchend', function(e) {
            touchEndY = e.changedTouches[0].clientY;
            handleSwipe();
        });

        function handleSwipe() {
            if (isScrolling) return;
            const swipeDistance = touchEndY - touchStartY;
            const threshold = 50;

            if (swipeDistance < -threshold && window.pageYOffset < cover.offsetHeight / 2) {
                isScrolling = true;
                content.scrollIntoView({ behavior: "smooth" });
            } else if (swipeDistance > threshold && window.pageYOffset >= cover.offsetHeight / 2 && content.scrollTop <= 0) {
                isScrolling = true;
                cover.scrollIntoView({ behavior: "smooth" });
            }
            setTimeout(() => { isScrolling = false; }, 1000);
        }

        const directoryContainer = document.getElementById('directory');
        let baseDirectory = "./courses"
        let currentNode = null;
        let rootTree = null;
        let pathStack = [];

        function renderDirectory(node) {
            directoryContainer.innerHTML = '';

            // è¿”å›æŒ‰é’®
            const backBtn = document.createElement('div');
            backBtn.className = 'back-btn';
            if (pathStack.length === 0) {
                backBtn.textContent = 'Estraieçš„ä¸»é¡µ';
                backBtn.onclick = () => window.open('https://Estraie.github.io', '_blank');
            } else {
                backBtn.textContent = 'â¬… è¿”å›ä¸Šä¸€çº§ Go up';
                backBtn.onclick = () => {
                    pathStack.pop();
                    const parent = getNodeFromPath(pathStack);
                    renderDirectory(parent);
                };
            }
            directoryContainer.appendChild(backBtn);

            // ä¸¤æ å®¹å™¨
            const fileContainer = document.createElement('div');
            fileContainer.className = 'file-container';

            const dirColumn = document.createElement('div');
            dirColumn.className = 'column';
            dirColumn.innerHTML = '<h2>ğŸ“‚ æ–‡ä»¶å¤¹ Directories</h2>';
            const dirList = document.createElement('ul');
            dirList.className = 'directory';
            
            // ç›®å½•é¡¹
            (node.directories || []).forEach(dir => {
                const li = document.createElement('li');
                li.textContent = dir.name;
                li.onclick = () => {
                    pathStack.push(dir.name);
                    renderDirectory(dir);
                };
                dirList.appendChild(li);
            });

            const fileColumn = document.createElement('div');
            fileColumn.className = 'column';
            let fileList;
            if(node.path !== "") {
                fileColumn.innerHTML = '<h2>ğŸ“œ æ–‡ä»¶ Files</h2>';
                fileList = document.createElement('ul');
                fileList.className = 'file-list';

                // æ–‡ä»¶é¡¹
                (node.files || []).forEach(file => {
                    const li = document.createElement('li');
                    const link = document.createElement('a');
                    link.href = baseDirectory + '/' + file.url;
                    link.target = '_blank';
                    link.textContent = file.name;
                    li.appendChild(link);
                    fileList.appendChild(li);
                });
            } else {
                const disclaimer = document.createElement('div');
                disclaimer.style.padding = '10px';
                disclaimer.style.color = '#5a4a42';
                disclaimer.style.fontSize = '0.95em';
                disclaimer.innerHTML = `
                    <h3>ğŸ“œ ä½¿ç”¨è¯´æ˜ä¸å…è´£å£°æ˜ Instructions and Disclaimer</h3>
                    <p>æœ¬ç½‘é¡µç”±<a href="https://Estraie.github.io" style="color: #347834; text-decoration: none;">Estraie</a>åˆ¶ä½œï¼Œæ—¨åœ¨æ”¶é›†ç»Ÿè®¡ä¸æ•°æ®ç§‘å­¦ç³»ç›¸å…³è¯¾ç¨‹çš„ä½œä¸šç­”æ¡ˆï¼Œä»¥å¸®åŠ©ä¸€äº›æ•°å­¦/ä»£ç è‹¦æ‰‹æ¸¡è¿‡éš¾å…³ã€‚ä½†è¯·æ³¨æ„ï¼š<strong>æœ¬äººä¸èƒ½ä¿è¯ç½‘ç«™ä¸Šç­”æ¡ˆçš„æ­£ç¡®æ€§ã€‚ä½ åº”è¯¥é¦–å…ˆè‡ªå·±æ€è€ƒé¢˜ç›®çš„è§£æ³•ï¼Œå³ä½¿å‚è€ƒç­”æ¡ˆä¹Ÿéœ€è¦ç”¨è‡ªå·±çš„æ–¹å¼æ£€æŸ¥ã€å¤ç°ä¸€éã€‚</strong></p>
                    <br>
                    <p>æ¬¢è¿å„ä½åŒå­¦é€šè¿‡Pull Requestæˆ–é€šè¿‡QQã€é‚®ç®±ï¼ˆ<a href="#" class="email" style="color: #347834; text-decoration: none;">li_leping@qq.com</a>ï¼‰ç­‰æ–¹å¼ç›´æ¥è”ç³»æˆ‘ï¼Œå…±åŒå»ºè®¾æœ¬ä»“åº“ï¼</p>
                    <br>
                    <p>å…³äºè¯¾ä»¶ã€å®˜æ–¹ç­”æ¡ˆç­‰å†…å®¹ï¼Œå¯èƒ½è€å¸ˆä¼šä»‹æ„å…¶è¢«å…¬å¼€ï¼Œå› æ­¤æœ¬ä»“åº“æš‚æ—¶æ²¡æœ‰æ”¶å½•ã€‚å¦‚æœ‰éœ€è¦ï¼Œå¯ç›´æ¥è”ç³»æˆ‘ã€‚</p>
                    <br>
                    <p>æœ¬ç½‘é¡µæš‚æ—¶æ²¡æœ‰è®¾ç½®æ‰¹é‡ä¸‹è½½åŠŸèƒ½ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä¾ç„¶å¸Œæœ›ä½ ä»¬ç‹¬ç«‹å®Œæˆä½œä¸šã€‚<del>ç»å¯¹ä¸æ˜¯æˆ‘ä¸ä¼šå†™æ‰¹é‡ä¸‹è½½åŠŸèƒ½ã€‚</del></p>
                    <br>
                    <p>å¦‚æœä½ è®¤ä¸ºæœ¬ç½‘é¡µçš„å†…å®¹æœ‰å¸®åŠ©åˆ°ä½ ï¼Œæ¬¢è¿ä½ é€šè¿‡æˆ‘çš„é‚®ç®±å‘ŠçŸ¥æˆ‘ï¼Œè¿™ä¼šè®©æˆ‘æ¯ç‡¥çš„ç”Ÿæ´»å¢æ·»ä¸€ä¸è‰²å½©ã€‚</p>
                    <br>
                    <p>This website is created by <a href="https://Estraie.github.io" style="color: #347834; text-decoration: none;">Estraie</a>, aiming to collect answers for assignments from courses related to statistics and data science, to help students struggling with mathematics or coding. However, please note: <strong>The correctness of answers on this page is not guaranteed. You should first think about the problem-solving approach on your own, even if you refer to answers, you should verify and replicate them in your own way.</strong></p>
                    <br>
                    <p>Feel free to contact me directly through Pull Requests or via QQ, email (<a href="#" class="email" style="color: #347834; text-decoration: none;">li_leping@qq.com</a>), etc. to contribute to the development of this repository!</p>
                    <br>
                    <p>Regarding course materials, official answers, etc., teachers may not be comfortable with them being publicly available, so they are not included in this repository for now. If needed, feel free to contact me directly.</p>
                    <br>
                    <p>This website does not currently have a bulk download feature, as I still hope you will complete assignments independently. <del>It's definitely not because I can't write the bulk download feature.</del></p>
                    <br>
                    <p>If you find the content of this website helpful, feel free to let me know via my email. It would bring some color to my dull life.</p>
                `;
                fileColumn.appendChild(disclaimer);
                
            }

            dirColumn.appendChild(dirList);
            if(fileList) {
                fileColumn.appendChild(fileList);
            }
            fileContainer.appendChild(dirColumn);
            fileContainer.appendChild(fileColumn);
            directoryContainer.appendChild(fileContainer);
            
            const emailElement = document.querySelector('.email');
            const email = "li_leping@qq.com";
                
            if(emailElement) {
                emailElement.onclick = () => {
                    event.preventDefault();
                    navigator.clipboard.writeText(email).then(() => {
                        alert("é‚®ç®±å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼");
                    }).catch(err => {
                        console.error("å¤åˆ¶å¤±è´¥ï¼š", err);
                    });
                };
            }
        }

        function getNodeFromPath(pathArr) {
            let node = rootTree;
            for (let name of pathArr) {
                node = (node.directories || []).find(d => d.name === name);
                if (!node) break;
            }
            return node || rootTree;
        }

        // åˆå§‹åŒ–åŠ è½½ JSON
        fetch('directory.json')
            .then(res => res.json())
            .then(data => {
                rootTree = data;
                pathStack = [];
                renderDirectory(rootTree);
            })
            .catch(err => {
                console.error('ç›®å½•åŠ è½½å¤±è´¥:', err);
                directoryContainer.innerHTML = 'âŒ åŠ è½½ç›®å½•å¤±è´¥ / Failed to load directory.';
            });
    </script>
    

    <!-- <script>
        document.addEventListener("mousemove", (e) => {
            const bg = document.getElementById("cover-bg");
            const moveX = (window.innerWidth / 2 - e.clientX) * 0.02;
            const moveY = (window.innerHeight / 2 - e.clientY) * 0.02;
            bg.style.transform = `translate(-50%, -50%) translate(${moveX}px, ${moveY}px)`;
        });

        let isScrolling = false;
        let fileStructure = {};
        window.addEventListener('wheel', function(e) {
            if (isScrolling) return;
            const cover = document.getElementById('cover');
            const content = document.getElementById('content');
            if (window.pageYOffset < cover.offsetHeight / 2 && e.deltaY > 0) {
                isScrolling = true;
                content.scrollIntoView({ behavior: "smooth" });
                setTimeout(() => { isScrolling = false; }, 1000);
            } else if (window.pageYOffset >= cover.offsetHeight / 2 && e.deltaY < 0 && content.scrollTop <= 0) {
                isScrolling = true;
                cover.scrollIntoView({ behavior: "smooth" });
                setTimeout(() => { isScrolling = false; }, 1000);
            }
            });

            const owner = 'Estraie';
            const repo = 'CelestialReverie';
            let currentPath = '';

            function fetchDirectory(path) {
            // å¦‚æœç¼“å­˜ä¸­å·²ç»æœ‰è¿™ä¸ªç›®å½•ç»“æ„ï¼Œç›´æ¥ä»ç¼“å­˜è¯»å–
            if (fileStructure[path]) {
                displayDirectory(fileStructure[path], path);
            } else {
                const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
                fetch(url)
                .then(response => response.json())
                .then(data => {
                    fileStructure[path] = data; // ç¼“å­˜ç›®å½•æ•°æ®
                    displayDirectory(data, path);
                })
                .catch(error => {
                    console.error('Error fetching directory:', error);
                    document.getElementById('directory').innerHTML = 'åŠ è½½å¤±è´¥ / Error loading.';
                });
            }
        }

        function displayDirectory(data, path) {
            const container = document.getElementById('directory');
            container.innerHTML = '';

            if (path) {
                const parentPath = path.split('/').slice(0, -1).join('/');
                const upButton = document.createElement('div');
                upButton.className = "back-btn";
                upButton.textContent = "è¿”å› Go up";
                upButton.addEventListener('click', function() {
                    currentPath = parentPath;
                    fetchDirectory(parentPath);
                });
                container.appendChild(upButton);
            } else {
                const upButton = document.createElement('div');
                upButton.className = "back-btn";
                upButton.textContent = "Estraieçš„ä¸»é¡µ";
                upButton.addEventListener('click', function() {
                    window.open('https://Estraie.github.io', '_blank');
                });
                container.appendChild(upButton);
            }

            const fileContainer = document.createElement('div');
            fileContainer.className = 'file-container';

            const dirColumn = document.createElement('div');
            dirColumn.className = 'column';
            dirColumn.innerHTML = '<h2>ğŸ“‚ æ–‡ä»¶å¤¹ Directories</h2>';
            
            const fileColumn = document.createElement('div');
            fileColumn.className = 'column';
            fileColumn.innerHTML = '<h2>ğŸ“œ æ–‡ä»¶ Files</h2>';

            const dirList = document.createElement('ul');
            dirList.className = 'directory';

            const fileList = document.createElement('ul');
            fileList.className = 'file-list';

            data.forEach(item => {
                const li = document.createElement('li');
                if (item.type === 'dir') {
                    li.textContent = item.name;
                    li.addEventListener('click', function() {
                        currentPath = path ? path + '/' + item.name : item.name;
                        fetchDirectory(currentPath); // ä½¿ç”¨ç¼“å­˜åŠ è½½
                    });
                    dirList.appendChild(li);
                } else if (item.type === 'file') {
                    const link = document.createElement('a');
                    link.href = item.download_url;
                    link.target = "_blank";
                    link.textContent = item.name;
                    li.appendChild(link);
                    fileList.appendChild(li);
                }
            });

            dirColumn.appendChild(dirList);
            fileColumn.appendChild(fileList);
            fileContainer.appendChild(dirColumn);
            fileContainer.appendChild(fileColumn);
            container.appendChild(fileContainer);
        }

        fetchDirectory('');
    </script> -->
</body>
</html>
